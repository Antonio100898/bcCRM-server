10/05/23 17:20  GetDataSet Exception Message: Incorrect syntax near ','.
. extraInfo: sql: SELECT [workerId], firstName + ' ' + lastName as workerName, ezShiftWorkerCode, Format(startExpenseDate,'yyyy/MM/dd') as eDate, Sum([expenseValue]) as sumExpense,  Sum(IIF([workExpensCategoryId]=1,[expenseValue], 0) as sumJobOut,  Sum(IIF([workExpensCategoryId]=2,[expenseValue], 0) as sumBonuses, STRING_AGG(workExpensName, ', ') As expensNames FROM [dbo].[workerExpenses] inner join workers on [workerExpenses].workerId = workers.id inner join WorkExpensesTypes on workerExpenses.expenseType = WorkExpensesTypes.id WHERE startExpenseDate>= @startDate AND startExpenseDate< @finishDate and cancel = 0 AND (workerExpenses.expenseType<>17)  AND workers.wDepartmentId= @wDepartmentId Group BY [workerId], firstName +' ' + lastName, ezShiftWorkerCode, Format(startExpenseDate, 'yyyy/MM/dd') ORDER BY workerName, eDate

10/05/23 17:23  GetDataSet Exception Message: Incorrect syntax near ','.
. extraInfo: sql: SELECT [workerId], firstName + ' ' + lastName as workerName, ezShiftWorkerCode, Format(startExpenseDate,'yyyy/MM/dd') as eDate, Sum([expenseValue]) as sumExpense,  Sum(IIF([workExpensCategoryId]=1,[expenseValue], 0) as sumJobOut,  Sum(IIF([workExpensCategoryId]=2,[expenseValue], 0) as sumBonuses, STRING_AGG(workExpensName, ', ') As expensNames FROM [dbo].[workerExpenses] inner join workers on [workerExpenses].workerId = workers.id inner join WorkExpensesTypes on workerExpenses.expenseType = WorkExpensesTypes.id WHERE startExpenseDate>= @startDate AND startExpenseDate< @finishDate and cancel = 0 AND (workerExpenses.expenseType<>17) Group BY [workerId], firstName +' ' + lastName, ezShiftWorkerCode, Format(startExpenseDate, 'yyyy/MM/dd') ORDER BY workerName, eDate

